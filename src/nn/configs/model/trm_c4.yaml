_target_: src.nn.models.trm_c4_module.TRMConnectFourModule
_recursive_: false  # Prevent recursive instantiation of nested configs

# TRM architecture
hidden_size: ${model_tuning.hidden_size}
num_layers:  ${model_tuning.num_layers}
num_heads:  ${model_tuning.num_heads}
H_cycles: ${model_tuning.H_cycles}
L_cycles: ${model_tuning.L_cycles}
N_supervision: ${model_tuning.N_supervision}
N_supervision_val: ${model_tuning.N_supervision_val}
ffn_expansion: ${model_tuning.ffn_expansion}

# Optimization
learning_rate: ${model_tuning.learning_rate}
weight_decay: ${model_tuning.weight_decay}
warmup_steps: ${model_tuning.warmup_steps}
max_steps: ${model_tuning.max_steps}
lr_min_ratio: ${model_tuning.lr_min_ratio}

# Loss weights
policy_weight: ${c4_tuning.policy_weight}
value_weight: ${c4_tuning.value_weight}
halt_weight: ${c4_tuning.halt_weight}
# Self-play
games_per_epoch: ${c4_tuning.games_per_epoch}
buffer_size: ${c4_tuning.buffer_size}
batch_size: ${c4_tuning.batch_size}
steps_per_epoch: ${c4_tuning.steps_per_epoch}

# MCTS
mcts_simulations: ${c4_tuning.mcts_simulations}
mcts_c_puct: ${c4_tuning.mcts_c_puct}
mcts_temperature: ${c4_tuning.mcts_temperature}
mcts_dirichlet_alpha: ${c4_tuning.mcts_dirichlet_alpha}
mcts_exploration_fraction: ${c4_tuning.mcts_exploration_fraction}

# Evaluation
eval_games_vs_minimax: ${c4_tuning.eval_games_vs_minimax}
minimax_temperature: ${c4_tuning.minimax_temperature}
minimax_depth: ${c4_tuning.minimax_depth}

# Output directory
output_dir: None
