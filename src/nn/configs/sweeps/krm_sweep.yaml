# configs/sweeps/trm_sudoku_sweep.yaml
name: krm-sudoku6x6-sweep
method: bayes
metric:
  name: val/exact_accuracy
  goal: maximize

parameters:
  model_tuning.d_base:
    values: [16, 32, 64]
  model_tuning.num_atoms:
    values: [2, 4, 8]
  model_tuning.num_layers:
    values: [1, 2, 3]
  model_tuning.num_heads:
    values: [2, 4, 8]
  model_tuning.ffn_expansion:
    values: [2, 4]
  model_tuning.N_supervision:
    values: [6, 8, 12]
  model_tuning.N_supervision_val:
    values: [8, 64, 128]
  model_tuning.H_cycles:
    values: [1, 2, 3]
  model_tuning.L_cycles:
    values: [1, 2, 3]
  model_tuning.hidden_size:
    values: [128, 256, 512]
  model_tuning.num_layers:
    values: [1, 2, 3]
  model_tuning.learning_rate:
    distribution: log_uniform_values
    min: 1e-4
    max: 1e-2

early_terminate:
  type: hyperband
  min_iter: 100
  eta: 3