_target_: src.nn.models.trm_c4.TRMC4Module
_recursive_: false  # Prevent recursive instantiation of nested configs

ffn_expansion: ${model_tuning.ffn_expansion}
hidden_size: ${model_tuning.hidden_size}
num_layers: ${model_tuning.num_layers}
N_supervision: ${model_tuning.N_supervision}
N_supervision_val: ${model_tuning.N_supervision_val}
learning_rate: ${model_tuning.learning_rate}
H_cycles: ${model_tuning.H_cycles}
L_cycles: ${model_tuning.L_cycles}
num_heads: ${model_tuning.num_heads}
learning_rate_emb: ${model_tuning.learning_rate_emb}
weight_decay: ${model_tuning.weight_decay}
halt_exploration_prob: ${model_tuning.halt_exploration_prob}
warmup_steps: ${model_tuning.warmup_steps}
puzzle_emb_dim: ${model_tuning.puzzle_emb_dim}
puzzle_emb_len: ${model_tuning.puzzle_emb_len}
rope_theta: ${model_tuning.rope_theta}
lr_min_ratio: ${model_tuning.lr_min_ratio}

steps_per_epoch: ${timekeeping.steps_per_epoch}
batch_size: ${timekeeping.batch_size}
max_epochs: ${timekeeping.max_epochs}

seq_len: ${model_tuning.seq_len}
vocab_size: ${model_tuning.vocab_size}

#self-play settings
enable_selfplay: ${model_tuning.enable_selfplay}
selfplay_buffer_size: ${model_tuning.selfplay_buffer_size}
selfplay_games_per_iteration: ${model_tuning.selfplay_games_per_iteration}
selfplay_mcts_simulations: ${model_tuning.selfplay_mcts_simulations}
selfplay_eval_mcts_simulations: ${model_tuning.selfplay_eval_mcts_simulations}
selfplay_parallel_simulations: ${model_tuning.selfplay_parallel_simulations}
selfplay_temperature_moves: ${model_tuning.selfplay_temperature_moves}
selfplay_update_interval: ${model_tuning.selfplay_update_interval}  # Update "previous model" every N epochs
selfplay_bootstrap_weight: ${model_tuning.selfplay_bootstrap_weight}
selfplay_temporal_decay: ${model_tuning.selfplay_temporal_decay}
eval_use_mcts: ${model_tuning.eval_use_mcts}
curriculum_data_path: ${model_tuning.curriculum_data_path}
        
# Evaluation parameters
eval_minimax_depth: ${model_tuning.eval_minimax_depth}
eval_minimax_temperature: ${model_tuning.eval_minimax_temperature}
eval_games_vs_minimax: ${model_tuning.eval_games_vs_minimax}
eval_games_vs_random: ${model_tuning.eval_games_vs_random}
eval_interval: ${model_tuning.eval_interval}

# Output directory
output_dir: None
